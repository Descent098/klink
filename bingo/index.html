<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" type="image/svg+xml" href="https://klnk.ca/favicon.svg"><meta name="generator" content="Astro v5.5.6"><title>Klnk</title><style>.bingoCell{width:var(--grid-size);height:var(--grid-size);display:flex;justify-content:center;align-items:center;font-size:var(--font-size);border:3px solid black;text-align:center;background:var(--background-cell-color);transition:all .2s}.bingoCell.available:hover{background:#ffeb3b;transform:rotate(-2deg);cursor:pointer}.taken{background:#141414;color:#f0f0f0;font-weight:700}.taken:hover{cursor:not-allowed}.ball{width:1.2rem;height:1.2rem;background:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:1.1rem;font-weight:700;color:#000;border:1px solid black;font-family:Indie Flower,cursive;text-align:center;padding:1rem}#gameButtons,button,#animationBox{transition:opacity 1s ease-out}#gameButtons{opacity:0;width:calc(var(--grid-size) * 5.1)}#bingoBoard{display:grid;opacity:0;grid-template-columns:repeat(5,var(--grid-size));grid-template-rows:repeat(5,var(--grid-size));gap:5px;padding:20px;background:var(--background-color);border:5px dashed black;box-shadow:5px 5px #000;transition:opacity 1s ease-out}#animationBox{display:None;top:-10%;left:30%;position:absolute;justify-content:center;align-items:center;height:100vh;width:40vw;overflow:hidden}#bingoBall{width:120px;height:120px;background:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:24px;font-weight:700;color:#000;border:5px solid black;position:absolute;opacity:0;font-family:Indie Flower,cursive;filter:url(#handDrawn);text-align:center}#challengeText{text-align:center;font-size:1.2rem;background:#000;color:#fff;border-radius:1.1rem;width:100%;margin:1rem 0 .2rem;padding:1.1rem}#setupGame{position:absolute;inset:0;z-index:100;display:flex;justify-content:center;align-items:center;gap:10px;flex-direction:column}#challengeList{padding:1.2rem;list-style-type:"üç∫"}#instructions{margin:0 auto;margin-top:20vh;padding:1.2rem;line-height:1.8;text-align:center;width:120ch}#instructions h2,#instructions h3{padding-top:1.1rem}#instructions button{margin-top:1.1rem;padding:.5rem;cursor:pointer}@media (max-width: 800px){:root{--grid-size: 75px;--font-size: 1.2rem}#bingoBoard{gap:5px;padding:15px}}@media (max-width: 500px){:root{--grid-size: 50px;--font-size: 1rem}#bingoBoard{gap:5px;padding:10px}.bingoCell{width:50px;height:50px;font-size:1.1rem}}
@import"https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap";*{box-sizing:border-box;margin:0;padding:0}:root{--background-color:#f0f0f0;--background-cell-color:#cacaca;--font-size: 1.5rem;--grid-size: 100px}html,body{width:100%;min-height:100vh}main{padding-top:1.3rem;display:flex;justify-content:center;align-items:center;min-height:100vh;flex-direction:column;width:100%}body{font-family:Indie Flower,cursive;font-weight:bolder;background-color:var(--background-color)}button,.btn{padding:1.1rem;border-radius:.8rem;background:#141414;color:#f0f0f0;font-family:Indie Flower,cursive;font-weight:bolder;text-transform:capitalize;font-size:var(--font-size);cursor:pointer;text-decoration:none}.secondary-btn{background:transparent!important;color:#000!important}details{padding:1.1rem;border-radius:.8rem;background:var(--background-cell-color);color:#000;font-family:Indie Flower,cursive;font-weight:bolder;text-transform:capitalize;font-size:var(--font-size);cursor:pointer;width:100%;margin-bottom:1.2rem}details[open] ul{padding-left:1.4rem;margin-left:1.4rem}
</style></head> <body> <nav></nav> <main>  <div id="animationBox"> <div id="bingoBall"></div> <!-- SVG filter for hand-drawn effect --> <svg> <defs> <filter id="handDrawn"> <!-- Stronger noise effect --> <feTurbulence type="fractalNoise" baseFrequency="0.03" numOctaves="4" result="noise"></feTurbulence> <!-- Increase distortion scale --> <feDisplacementMap in="SourceGraphic" in2="noise" scale="5"></feDisplacementMap> <!-- Slight blur to soften the edges --> <feGaussianBlur stdDeviation="0.6"></feGaussianBlur> </filter> </defs> </svg> </div> <div id="bingoBoard"></div> <div id="gameButtons"> <h3 id="challengeText">Current Challenge: <span id="currentChallenge">Take a Drink</span></h3> <details><summary>Previous Challenges</summary> <ul id="challengeList"></ul> </details> <button onclick="currentGame.nextBall()">Next Ball</button> <hr style="margin-top:1.1rem;"> </div> <div id="setupGame"> <h1>üç∫Klnk Bingoüç∫</h1> <button id="startGame" onclick="startGame()" style="cursor:pointer;">Start game</button> <button class="secondary-btn" onclick="document.getElementById('instructions').showModal();body.style.overflow='hidden';">Instructions</button> <dialog id="instructions"> <h2 style="text-decoration:underline">üç∫Klink Bingoüç∫</h2> <h2>Here's a description of the game</h2> <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Obcaecati sunt tenetur itaque aperiam maiores ad repellat repellendus placeat, veniam, animi at laudantium. Dicta quibusdam distinctio facilis labore quis voluptatibus eos.</p> <h3>Here's a description of the game</h3> <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Iure, quod. Laudantium maxime voluptas error, suscipit dolores voluptatum, asperiores dolore culpa, ducimus qui officiis voluptate magni consequuntur? Necessitatibus odio veritatis ratione!</p> <button onclick="document.getElementById('instructions').close();body.style.overflow='auto';" autofocus>Close</button> </dialog> </div> <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script> <script>
    let currentGame = null;

    /**
     * Gets a random integer
     * @param {Number} min - The minimum value
     * @param {Number} max - The maximum value
     * @returns {Number} The random number
     */
    function getRandomInt(min, max) {
        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random#getting_a_random_integer_between_two_values
        const minCeiled = Math.ceil(min);
        const maxFloored = Math.floor(max);
        return Math.floor(Math.random() * (maxFloored - minCeiled) + minCeiled); // The maximum is exclusive and the minimum is inclusive
    }        

    class Ball {
        /**
         * A class to represent a single bingo ball
         * 
         * @param {"B"|"I"|"N"|"G"|"O"} letter - The letter to use
         * @param {Number} number - The number of the bold
         * @param {String} challenge - The challenge to get the next ball
         */
        constructor(letter, number, challenge) {
            this.letter = letter;
            this.number = number;
            this.challenge = challenge;
            this.chosen = false;
        }

        html(){
            return `${this.letter}<br>${this.number}`
        }

        /**
         * Runs the animation for a ball being picked
         */
        runAnimation(){
            console.log("starting animation for", this.letter, this.number)
            document.getElementById("animationBox").style.display = "flex"
            document.getElementById("animationBox").style.opacity = "1"
            console.log("should now be visible")
            const ball = document.getElementById("bingoBall");
            ball.innerHTML = this.html()

            // Timeline for bouncing with squash & stretch
            const tl = gsap.timeline({ defaults: { ease: "power2.out" } });
            let start = -300;
            let end = 300;
            tl.fromTo(ball, 
                { y: start, scaleY: 1.2, scaleX: 0.8, opacity: 1 }, 
                { y: end, scaleY: 0.8, scaleX: 1.2, duration: 0.6, ease: "power1.in" }
            )
            .to(ball, { y: ((end/2) +0.1*end), scaleY: 1.2, scaleX: 0.8, duration: 0.3, ease: "power2.out" })
            .to(ball, { y: end, scaleY: 0.8, scaleX: 1.2, duration: 0.3, ease: "power1.in" })
            .to(ball, { y: end - (end*.25), scaleY: 1.1, scaleX: 0.9, duration: 0.2, ease: "power2.out" })
            .to(ball, { y: end, scaleY: 0.9, scaleX: 1.1, duration: 0.2, ease: "power1.in" })
            .to(ball, { y: (end-(0.1*end)), scaleY: 1.05, scaleX: 0.95, duration: 0.15, ease: "power2.out" })
            .to(ball, { y: end, scaleY: 1, scaleX: 1, duration: 0.15, ease: "power1.in" })
            .to(ball, { opacity: 1, duration: 0.8 })
            .to(ball, { opacity: 1, duration: 3 });
            setTimeout(()=>{
                document.getElementById("animationBox").style.opacity = "0"
            }, 2000)
            setTimeout(()=>{
                document.getElementById("animationBox").style.display = "none"
            }, 3000)
            
        }
        }

    class Game{
        constructor(BOARD_HEIGHT = 5){
            this.BOARD_HEIGHT = BOARD_HEIGHT
            let unusedBalls = {"B":[],"I":[],"N":[],"G":[],"O":[]}
            let currentNum = 1
            let board = {"B":[],"I":[],"N":[],"G":[],"O":[]}
            let remainingBalls = []
            let FREE_SPACE_POSITION = Math.ceil(BOARD_HEIGHT/2) - 1
            
            // Generate all possible balls
            for (const letter of ["B","I","N","G","O"]){
                for (let i=0; i < 15; i++){
                    // TODO: generate random challenge
                    let challenge = "drink"
                    unusedBalls[letter].push(new Ball(letter, currentNum, challenge))
                    currentNum++
                }
            }
            

            // Pick balls to be used for the game
            for (const letter of ["B","I","N","G","O"]){
                for (let i=0; i < BOARD_HEIGHT; i++){
                    if (letter == "N" && i == FREE_SPACE_POSITION){
                        let temp = new Ball("Free", "FREE", undefined)
                        temp.chosen = true
                        board[letter].push(temp)
                        continue
                    }
                    console.log(unusedBalls, letter, unusedBalls[letter])
                    let randomIndex = getRandomInt(0,unusedBalls[letter].length)
                    const randomBall = unusedBalls[letter].splice(randomIndex, 1)[0];
                    board[letter].push(randomBall)
                    remainingBalls.push(randomBall)
                }
            }

            // Assign balls to member variables
            this.unusedBalls = unusedBalls
            this.board = board
            this.remainingBalls = remainingBalls

            // Build out game board HTML
            document.getElementById("bingoBoard").innerHTML = `
            <div class="bingoCell taken">B</div>
            <div class="bingoCell taken">I</div>
            <div class="bingoCell taken">N</div>
            <div class="bingoCell taken">G</div>
            <div class="bingoCell taken">O</div>`
            
            for (let i =0; i < BOARD_HEIGHT; i++){
                if (i == FREE_SPACE_POSITION){
                    document.getElementById("bingoBoard").innerHTML +=`
                <div id="B${this.board["B"][i].number}" class="bingoCell available">${this.board["B"][i].number}</div>
                <div id="I${this.board["I"][i].number}" class="bingoCell available">${this.board["I"][i].number}</div>
                <div id="N${this.board["N"][i].number}" class="bingoCell taken">${this.board["N"][i].number}</div>
                <div id="G${this.board["G"][i].number}" class="bingoCell available">${this.board["G"][i].number}</div>
                <div id="O${this.board["O"][i].number}" class="bingoCell available">${this.board["O"][i].number}</div>
                `
                continue
                }
                
                document.getElementById("bingoBoard").innerHTML +=`
                <div id="B${this.board["B"][i].number}" class="bingoCell available">${this.board["B"][i].number}</div>
                <div id="I${this.board["I"][i].number}" class="bingoCell available">${this.board["I"][i].number}</div>
                <div id="N${this.board["N"][i].number}" class="bingoCell available">${this.board["N"][i].number}</div>
                <div id="G${this.board["G"][i].number}" class="bingoCell available">${this.board["G"][i].number}</div>
                <div id="O${this.board["O"][i].number}" class="bingoCell available">${this.board["O"][i].number}</div>
                `
                
            }
            document.getElementById("bingoBoard").style.opacity = "1"
        }

        getRandomBall(){
            if (this.remainingBalls.length === 0) return null; // Prevents errors if array is empty

            const randomIndex = Math.floor(Math.random() * this.remainingBalls.length);
            const randomBall = this.remainingBalls.splice(randomIndex, 1)[0]; 

            return randomBall
        }

        print(){
            let rows = []
            for (let i=0;i<this.BOARD_HEIGHT;i++){
                rows.push(
                    {
                        "B":this.board["B"][i].number, 
                        "I":this.board["I"][i].number, 
                        "N":this.board["N"][i].number, 
                        "G":this.board["G"][i].number, 
                        "O":this.board["O"][i].number
                })
            }
            console.table(rows)
        }

        nextBall(){
            console.log("Getting next ball")
            let ball = this.getRandomBall()
            console.log("got next ball", ball)
            ball.runAnimation()
            ball.chosen= true
            document.getElementById(`${ball.letter}${ball.number}`).classList.add("taken")
            document.getElementById(`${ball.letter}${ball.number}`).classList.remove("available")
            document.getElementById("currentChallenge").innerHTML = ball.challenge
            document.getElementById("challengeList").innerHTML += `<li><span class="ball">${ball.letter}${ball.number}</span>Challenge: ${ball.challenge}</li>`
        }
    }

    function startGame(){
        document.getElementById("setupGame").style.display = "None";
        currentGame = new Game()
        document.getElementById("gameButtons").style.opacity = 1;
        
    }


    </script>   </main> </body></html>